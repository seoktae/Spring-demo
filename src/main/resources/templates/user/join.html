<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{/css/user.css}">
    <script src="../webjars/jquery/3.4.1/dist/jquery.min.js"></script>
    <title>회원가입</title>
</head>
<body cellpadding="0" cellspacing="0" marginleft="0" margintop="0" width="100%" height="100%" align="center" >
<div class="card align-middle" style="width:50rem; border-radius:20px;">
    <div class="card-title" style="margin-top:30px;">
        <h2 class="card-title text-center" style="color:#113366;">회 원 가 입</h2>
    </div>
    <div class="card-body">
        <form name="join_frm" class="form-control" onsubmit="return insertChk()" action="/user/join" method="post">
            <div class="form-group">
                <label for="email" class="cols-sm-2 control-label">아이디</label>
                <div class="cols-sm-10">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="fa fa-user fa" aria-hidden="true"></i></span>
                        <input type="text" class="form-control" name="userName" id="userName"
                               placeholder="사용하실 ID를 입력해주세요."/>
                    </div>
                    <span id="id_check" style="color: rgb(255, 90, 0);"></span>
                </div>
            </div>
            <div class="form-group">
                <label for="password" class="cols-sm-2 control-label">비밀번호</label>
                <div class="cols-sm-10">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="fa fa-lock fa-lg" aria-hidden="true"></i></span>
                        <input type="password" class="form-control" name="password" id="password"
                               placeholder="영문 대소문자, 숫자 및 특수문자 6~18자 조합 입력하세요."/>
                    </div>
                    <span id="pwconcheck_text" style="color: rgb(255, 90, 0);"></span>
                </div>
            </div>
            <div class="form-group">
                <label for="confirm" class="cols-sm-2 control-label">비밀번호 확인</label>
                <div class="cols-sm-10">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="fa fa-lock fa-lg" aria-hidden="true"></i></span>
                        <input type="password" class="form-control" name="password2" id="password2"
                               placeholder="패스워드를 다시 입력해주세요."/>
                    </div>
                    <span id="pwconcheck_textRe" style="color: rgb(255, 90, 0);"></span>
                </div>
            </div>

            <input type="hidden" id="idChk" value="N"/>
            <input type="hidden" id="nameChk" value="N"/>
            <input type="hidden" id="passChk" value="N"/>
            <input type="hidden" id="confChk" value="N"/>

            <div class="form-group" style="border-top: 1px solid #ccc; padding-top: 10px">
                <input type="submit" value="등록" class="btn btn-info btn-lg btn-block login-button">
                <a href="${pageContext.request.contextPath}/"
                   class="btn btn-info btn-lg btn-block login-button">취소</a>
            </div>

        </form>
    </div>

</div>
</body>
<script>
    $("#password").keyup(function(){
        pwCheck();
    });
    $('#password2').keyup(function(){
        pwconCheck();
    });

    //비밀번호 체크
    function pwCheck(obj){
        var frm=document.join_frm;
        //var PT_pwtype = /^(?=([a-zA-Z]+[0-9]+[a-zA-Z0-9]*|[0-9]+[a-zA-Z]+[a-zA-Z0-9]*)$).{6,18}/;
        //var PT_pwtype = /^(?=([a-zA-Z0-9]+[!,@,#,$,%,^,&,*,?,_,~]*)|([!,@,#,$,%,^,&,*,?,_,~]+[a-zA-Z0-9])$).{6,18}/;
        var PT_pwtype = /^(?=.*[a-zA-Z])(?=.*[!@#$%^&*+=-])(?=.*[0-9]).{6,18}$/;
        pwconCheck(obj);
        if(!PT_pwtype.test(frm.password.value)) {
            $("#pwconcheck_text").css("color","#FF5A00").html('영문 대소문자, 숫자 및 특수문자 6~18자 조합 입력하세요.');
            //6~18 자리의 영문과 숫자 조합이어야만 합니다
            $("#passChk").val('N');
            return false
        } else {
            if(frm.password.value.length < 6 || frm.password.value.length > 18 ){
                $("#pwconcheck_text").css("color","#FF5A00").html('영문 대소문자, 숫자 및 특수문자 6~18자 조합 입력하세요.');
                //6~18 자리의 영문과 숫자 조합이어야만 합니다
                $("#passChk").val('N');
                return false
            }
            $("#pwconcheck_text").css("color","#00B050").html('이 비밀번호는 사용가능 합니다.');
            //이 비밀번호는 사용할 수 있습니다
            $("#passChk").val('Y');
        }
    }
    function pwconCheck(obj){
        var frm=document.join_frm;
        if(frm.password.value.length>0 && frm.password2.value.length>0) {
            if(frm.password.value != frm.password2.value){
                $("#pwconcheck_textRe").css("color","#FF5A00").html('비밀번호가 일치하지 않습니다.');
                //비밀번호가 일치하지 않습니다
                $("#confChk").val("N");
                return false;
            }
            $("#pwconcheck_textRe").css("color","#00B050").html('비밀번호가 일치합니다.');
            //'비밀번호가 일치합니다.'
            $("#confChk").val("Y");
        } else {
            $("#pwconcheck_textRe").html('');
            $("#pw_con_flag").val('N');
            return false;
        }
    }

    $("#userName").blur(function(){
        $.ajax({
            url : "/user/idcheck/" + $("#userName").val(),
            type : "GET",
            success: function(result) {
                if(result == 1) {
                    $("#id_check").css("color","#FF5A00").html("중복된 아이디가 있습니다.");
                    $("#idChk").val('N');
                } else {
                    $("#id_check").css("color","#00B050").html("사용가능합니다.");
                    $("#idChk").val('Y');
                }
            },
        })
    });

    function insertChk(){
        var frm=document.join_frm;
        if($("#idChk").val() == 'N'){
            frm.user_id.focus();
            return false;
        }
        if($("#passChk").val() == 'N'){
            frm.user_pw.focus();
            return false;
        }
        if($("#confChk").val() == 'N'){
            frm.password2.focus();
            return false;
        }
    }



</script>
</html>
